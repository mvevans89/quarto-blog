{
  "hash": "87e18a29945a6df6032b4181d0156340",
  "result": {
    "markdown": "---\ntitle: \"Creating a streetmap of Montpellier\"\ndescription: \"Day 8 of the #30DayMapChallenge - OpenStreetMap\"\nauthor: \"Michelle Evans\"\ndate: \"2022-11-08\"\ndraft: false\nimage: mtp-ouef.jpeg\nexecute:\n  warning: false\n  message: false\n  eval: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(ggtext)\nlibrary(showtext)\nlibrary(sf)\n\nlibrary(osmdata)\n\n#add font awesome\nfont_add('fa-brands', here::here('fonts/fa-brands-400.ttf'))\nfont_add('morris-roman', here::here('fonts/MorrisRoman-Black.ttf'))\nshowtext_auto()\n\nlibrary(dplyr)\n```\n:::\n\n\n\n![Image Source: Marie de Montpellier](mtp-ouef.jpeg){height=10cm}\n\nFor today's challenge, I wanted to map the historical center of Montpellier, Écusson, using available OpenStreetMap data. Montpellier has one of the largest pedestrian zones in Europe, and it is located in the historical center of the city.\n\nAlthough there is a way to download data in a scripted way via the `osmdata` package, I was finding it to be a bit slow. In my impatience, I just downloaded the data manually via [overpass turbo](https://overpass-turbo.eu/). I downloaded the pedestrian ways and the buildings.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#manually downloaded from overpass API\nmtp.path <- st_read(\"mtp-pedestrian.gpkg\") %>%\n  select(surface, old_name, historic)\nsf_use_s2(FALSE)\nmtp.building <- st_read(\"mtp-buildings.gpkg\") %>%\n  select(roof_material, source_heritage,building_levels, historic,height)\n```\n:::\n\n\nI decided I wanted to plot this map in the shape of egg because 1) I was too lazy to change the CRS out of WGS84 and using a standard buffer on this will be elongated because Montpellier is at a 43 deg. latitude and 2) because La place de la Comédie in the historical center used to be called l'œuf, or \"the egg\", because of the shape of the paving stones. I created a buffer and used this to mask the path and building data using `st_intersection`. I decided it needed a medieval-style font and settled on [Morris Roman Black](https://www.1001freefonts.com/morris-roman-black.font)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtp.cent <- c(3.876616, 43.610607)\nmtp.buffer <- st_point(mtp.cent) %>%\n  st_sfc(crs = 4326) %>%\n  st_buffer(dist = 0.005)\n\n#crop with the nice circle\npath.crop <- st_intersection(mtp.path, mtp.buffer)\nbuild.crop <- st_intersection(mtp.building, mtp.buffer)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#define caption for easier reading\ncaption.lab <- paste0(\"#30DayMapChallenge | \",\n                      \"<b>Source: </b>OpenStreetMap<br>\",\n                      \"<span style='font-family:fa-brands;'>&#xf113;</span> mvevans89\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npng(\"centre-map.png\", res = 200, width = 600, height = 1100)\nggplot() +\n  geom_sf(data = mtp.buffer, fill = \"#E0C9A6\", color = \"gray30\", alpha = 0.6) +\n  geom_sf(data = build.crop, fill = \"#532915\", color = \"gray30\", size = 0.1, alpha = 0.4) +\n  # geom_sf(data = path.crop, color = \"#532915\", size = 0.6, alpha = 1) +\n  theme_void() +\n  coord_sf(clip = \"off\") +\n  labs(title= \"L'Ecusson\",\n       caption = caption.lab) +\n  geom_richtext(aes(x = 3.8766, y = 43.6047, label = \"<span style=;font-family:morris-roman;'>Le centre historique<br>de Montpellier</span>\"), fill = NA, label.color = NA,\n                color = \"black\", size = 5, hjust = 0.5, vjust = 0.5) +\n  theme(plot.title = element_text(family = \"morris-roman\", hjust = 0.5, size = 25),\n        plot.caption  = element_markdown(family = \"serif\", hjust = 0.5, size = 6))\ndev.off()\n```\n:::\n\n\n![](centre-map.png){height=12cm fig-align=\"center\"}\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}