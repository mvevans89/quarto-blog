{
  "hash": "c5e00c48ee815eb13be46867a52af239",
  "result": {
    "markdown": "---\ntitle: \"Map projections in ggplot\"\ndescription: \"Day 19 of the #30DayMapChallenge - Globe\"\nauthor: \"Michelle Evans\"\ndate: \"2023-01-17\"\ndraft: false\nimage: ww-inverse2.png\nexecute:\n  warning: false\n  message: false\n---\n\n\n\n![You wanna change... the map? Source: The West Wing](ww-inverse2.png)\n\n\n\n\n\nAs anyone familiar with Aaron Sorkin's West Wing knows, [map projections are biased](https://www.youtube.com/watch?v=vVX-PrBRtTY). In one episode of the West Wing, the fictitious Organization of Cartographers for Social Equality make the point that the commonly used Mercator map projection distorts the sizes of continents in favor of Europe and North America, essentially making the southern hemisphere continents seem much smaller than they actually are and presenting a eurocentric view of the world. They propose an alternate map projection: the Gall-Peters projection, which has an astonishingly detailed [wikipedia page](https://en.wikipedia.org/wiki/Gall%E2%80%93Peters_projection).\n\n# Changing Map Projections in R\n\nUnderstanding and using different map projections is an important part of correct GIS analyses and visualization and is remarkably straight-forward in the `sf`+`ggplot` universe. Below are two ways to transform map projections in R:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#get map of countries via natural earth\nworld.poly <- ne_countries(returnclass = \"sf\")\n\n#first method: transform via sf\nworld.poly %>%\n  st_transform(crs = 4326) %>%\n  ggplot() +\n  geom_sf()+\n  theme_minimal() +\n  ggtitle(\"Change projection via st_transform\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#second method: change crs of plot\nggplot() +\n  geom_sf(data = world.poly) +\n  theme_minimal() +\n  coord_sf(crs = 4326) +\n  ggtitle(\"Change projection within ggplot using coord_sf\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\nThey result in identical maps and which you use is up to you. Using the within ggplot `coord_sf` method is similar to projecting 'on the fly' in some GIS software. The projection is just being updated for the visualization but the underlying data projection remains unchanged.\n\n## Providing a coordinate reference system (CRS)\n\nEither method takes one of the following arguments for the coordinate reference system (CRS):\n\n- object of class `crs` created via the `st_crs` function. This might be used if you wanted to match the CRS of another dataset, just calling `st_crs(second_data)` as the argument.\n\n- input string that `st_crs` can read. The format of this can vary widely. I most often reference a CRS using its EPSG number, as above. There is a database of all EPSG codes at [epsg.io](https://epsg.io/) and you can even look up the most commonly used CRS for each country. This can then be provided in numeric (e.g. 3857) or a string format (e.g. \"EPSG:3857\"). Some common EPSG codes are:\n\n| **EPSG** | **CRS Name**     |\n|----------|------------------|\n| 4326     | WGS 84           |\n| 3857     | Web Mercator     |\n| 4269     | NAD83            |\n| 6842     | MODIS Sinusoidal |\n\nSometimes there may not be a code for a certain CRS you want to use, or the code may not exist in the GDAL EPSG support files. Then you can provide a longer [proj-string](https://proj.org/usage/quickstart.html) with specific information about things like the datum, ellipsoid, projection, true scales, etc. These are referred to as `PROJ.4` strings in the EPSG database. For example, the full proj-string for WGS 84 (EPSG  4326) is `+proj=longlat +datum=WGS84 +no_defs +type=crs`.\n\n# Making the West Wing Map\n\nTo make a global map in the Gall-Peters projection, we first need to find the EPSG code or proj-string. There is no EPSG code for this projection, but the custom CRS is described in this [SO post](https://gis.stackexchange.com/questions/194295/getting-borders-as-svg-using-peters-projection). Then we can save this and provide it to `coord_sf`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngall.peters.proj <- \"+proj=cea +lon_0=0 +x_0=0 +y_0=0 +lat_ts=45 +ellps=WGS84 +datum=WGS84 +units=m +no_defs\"\n\nggplot() +\n  geom_sf(data = world.poly) +\n  theme_minimal() +\n  coord_sf(crs = gall.peters.proj) +\n  ggtitle(\"Gall-Peters Projection\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nThis works, but let's see if we can't make it more closely match the West Wing map. For that, we need to drop Antarctica and change some of the color palettes and fonts.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngp.poly <- world.poly %>%\n  filter(continent != \"Antarctica\") %>%\n  #add colors\n  mutate(poly_col = case_when(\n    name_sort == \"India\" ~ \"#284D47\",\n    name_sort == \"Saudi Arabia\" ~ \"#A15833\",\n    name_sort == \"Yemen, Rep.\" ~ \"#A15833\",\n    name_sort == \"Australia\" ~ \"#0E0805\",\n    name_sort == \"Russian Federation\" ~ \"#61121F\",\n    name_sort == \"United Arab Emirates\" ~ \"#61121F\",\n    name_sort == \"Oman\" ~ \"#61121F\",\n    name_sort == \"Canada\" ~ \"#232411\",\n    name_sort == \"United States of America\" ~ \"#B98C69\",\n    name_sort == \"Mexico\" ~ \"#B54F79\",\n    name_sort == \"New Zealand\" ~ \"gray50\",\n    subregion == \"Melanesia\" ~ \"gray50\",\n    subregion == \"Western Europe\" ~\"#491218\",\n    subregion == \"Northern Europe\" ~\"#491218\",\n    subregion == \"Central Asia\" ~ \"#61121F\",\n    subregion == \"Western Asia\" ~ \"#61121F\",\n    subregion == \"Southern Asia\" ~ \"#61121F\",\n    continent == \"Africa\" ~ \"#371013\",\n    continent == \"South America\" ~ \"#140D08\",\n    subregion == \"Central America\" ~ \"#140D08\",\n    continent == \"North America\" ~ \"#140D08\",\n    continent == \"Europe\" ~ \"#491218\",\n    subregion == \"Eastern Asia\" ~ \"#D4A14E\",\n    subregion == \"South-Eastern Asia\" ~ \"#D4A14E\",\n    TRUE ~ \"gray50\"\n  )) %>%\n  st_transform(crs=gall.peters.proj)\n\npeters.plot <- ggplot() +\n  geom_sf(data = gp.poly, aes(fill = poly_col), color = \"gray60\", size = 0.2) +\n  scale_fill_identity() +\n  theme_minimal() +\n  annotate(\"richtext\", x = 2e6, y = -6e6, label = \"PETER'S PROJECTION MAP\", \n           fill = \"#431613\", color = \"white\", size = 14, family = \"jeopardy\") +\n  coord_sf(crs = gall.peters.proj, xlim = c(-14190000, 14190000), \n           ylim = c(-7403000, 8929000)) +\n  #add plot annotation\n  # annotate(\"label\", x = 0, y = -80, label = \"Peter's Projection Map\") +\n  theme(panel.background = element_rect(fill = \"#D6C4B8\", color = NA),\n        plot.background = element_rect(fill = \"#D6C4B8\"),\n        panel.grid = element_line(color = \"gray20\"),\n        axis.text = element_blank(),\n        axis.title = element_blank()) \n```\n:::\n\n\n\n\n\n::: {layout-ncol=2}\n![Peter's Projection in R](peters-map.png)\n\n![Peter's Projection on West Wing](peters-ww2.png)\n:::\n\nHonestly, it is not too bad. Glad to see that R can reproduce the special effects of an early 2000's political drama.",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}